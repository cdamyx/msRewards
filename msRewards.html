<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Automate MS Rewards</title>
</head>
<body>
    
    <div id="buttonContainer" style="display: flex; justify-content: center">
        <button id="button" onclick="myFunc()" style="height: 100px; width: 200px; background-color: #00205C; color: #FFCD01; font-size: 18px">
            <strong>Click to Run 30 Searches</strong>
        </button>
    </div>

    <script>
        function myFunc(){
            for(let i = 0; i < 34; i++){
                //final simplified - may need to adjust time delay depending on missing searches
                let searchURL = "https://bing.com/search?q=" + i.toString();
                setTimeout(function(){open(searchURL, '_blank');}, i * 1500);

                //this was version 2 without IIFE
                // function searcher(){
                //     setTimeout(function(){
                //         window.open(searchURL, '_blank');
                //     }, 2000);
                // }
                // searcher();


                //this was the first version of the working code:
                //this is an IIFE (immediately invoked function expression) anonymous function
                //(function(i){
                //    setTimeout(function(){window.open(searchURL, '_blank');}, i * 2000);
                //}(i));
            }
        }
    </script>
</body>
</html>